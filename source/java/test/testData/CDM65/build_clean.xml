<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="./ant2html.xsl"?>
<!-- ================================================================ -->
<!-- nike.net build file                                              -->
<!-- The three build files for the server are as follows:                      -->
<!--     build.xml - used to build/distribute/run the CDM app or legacy app    -->
<!--                 on Windev.  Not for server distribution.                  -->
<!--     build-main.xml - used to create/configure/install the "external"      -->
<!--                      (outside cdm-main) data directory (cdm-main-data)    -->
<!--     build-server.xml - used for configuring the Weblogic domain and       -->
<!--                        "installing" CDM into that domain                  -->
<!--     build-batch.xml - used to create the "external" (outside cdm-batch)   -->
<!--                       data directory (cdm-batch-data)                     -->
<!--                                                                           -->
<!-- Ant docs:  http://jakarta.apache.org/ant/manual/                 -->
<!-- ================================================================ -->
<project name="cdm-clean">



    <!-- ======================================================= -->
    <!-- Cleans up the build environment                         -->
    <!-- ======================================================= -->
    <target name="clean-all" depends="clean,clean-deploy" unless="clean.all.done,configure.done"
        description="clean out the entire build, and removes the WebLogic domain. You will need to do a 'configure' and 'install-configure-weblogic' to get it all back">
        <delete dir="${output}"/>
        <make-dirs/>
        <property name="clean.all.done" value="true"/>
    </target>


    <target name="clean-jsps" unless="configure.done"
        description="Clean up JSP generated .java and .class files in the domain"
        depends="init">
        <delete quiet="true">
            <fileset dir="${cdmdomain}/${cdm.main.weblogic.server.name}/.wlnotdelete/extract/${cdm.main.weblogic.server.name}_cdm_CDM_Web/jsp_servlet/_WEB_45_INF/_jsp">
                <include name="**/*.java"/>
                <include name="**/*.class"/>
            </fileset>
        </delete>
        <make-dirs/>
    </target>

    <!--    Clears out the cdm domain directory and recreates a fresh, emtpy one.-->
    <target name="clean-domain" depends="init" if="cdm.domain.exists" unless="configure.done"
        description="Clears out the cdm domain directory and recreates a fresh, emtpy one.">
        <delete dir="${cdmdomain}" quiet="true"/>
        <make-dirs/>
    </target>


    <!--    Needed for junit report task-->
    <target name="clean-classes" depends="init">
        <delete dir="${output}/*classes" quiet="true"/>
        <make-dirs/>
    </target>



    <!-- ======================================================= -->
    <!-- Cleans up the build environment                         -->
    <!-- ======================================================= -->
    <target name="clean" depends="clean-checkin,clean-deploy,clean-legacy" unless="clean.done,configure.done"
        description="Cleans up the build environment.  Cleans out the classes and all deploy directories,
        and does some ClearCase housekeeping (gets rid of .keep files and the like).">
        <property name="clean.done" value="true"/>
    </target>

    <target name="clean-legacy">
        <ant antfile="build-legacy.xml" target="legacy-clean-all"/>
    </target>

    <target name="clean-checkin" depends="init,clean-jsps,clean-build,clean-jaxb,clean-classes,clean-tests,break-links" unless="clean.checkin,configure.done">
        <echo> dir="${classes}"</echo>
        <echo> dir="${test.classes}"</echo>
        <echo> dir="${integration.classes}"</echo>
        <echo> dir="${cdm.main.approot}/cdm"</echo>
        <echo> dir="${base.dir} hey, it's filtered - don't have a panic attack!!!!"</echo>

        <delete dir="${classes}" quiet="true"/>
        <delete dir="${test.classes}" quiet="true"/>
        <delete dir="${test.data.output}" quiet="true"/>
        <delete dir="${integration.classes}" quiet="true"/>
        <delete dir="${cdm.main.approot}/cdm" quiet="true"/>

        <delete quiet="true">
            <fileset dir="${output}">
                <include name="**/*.log"/>
                <include name="**/*.bak"/>
            </fileset>
        </delete>

        <delete>
            <fileset dir="${base.dir}">
                <include name="**/*.contrib*"/>
                <include name="**/*.keep*"/>
                <include name="**/*.log"/>
                <include name="**/*.bak"/>
            </fileset>
        </delete>
        <make-dirs/>
        <property name="clean.checkin" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- Cleans the docs directory                               -->
    <!-- ======================================================= -->
    <target name="clean-coverage" depends="init" unless="clean.coverage,configure.done"
        description="Cleans the docs directory">
        <delete dir="${coverage.dir}" quiet="true"/>
        <make-dirs/>
        <property name="clean.coverage" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- Cleans the docs directory                               -->
    <!-- ======================================================= -->
    <target name="clean-docs" depends="init" unless="clean.docs,configure.done"
        description="Cleans the docs directory">
        <delete dir="${docs}" quiet="true"/>
        <make-dirs/>
        <property name="clean.docs" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- Cleans the tests directory                               -->
    <!-- ======================================================= -->
    <target name="clean-tests" depends="init" unless="clean.tests,configure.done"
        description="Cleans the tests directory">
        <delete dir="${docs}/test" quiet="true"/>
        <delete dir="${docs}/integrationTest" quiet="true"/>
        <delete dir="${output}/test_classes" quiet="true"/>
        <delete dir="${test.data.output}" quiet="true"/>
        <delete dir="${output}/integration_classes" quiet="true"/>
        <make-dirs/>
        <property name="clean.tests" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- Cleans the xml files in the tests directory             -->
    <!-- ======================================================= -->
    <target name="clean-tests-xml" depends="init" unless="clean.tests.xml,configure.done"
        description="Cleans the xml files in the tests directory">
        <delete quiet="true">
            <fileset dir="${docs}/test">
                <include name="**/*.xml"/>
            </fileset>
            <fileset dir="${docs}/integrationTest">
                <include name="**/*.xml"/>
            </fileset>
        </delete>
        <make-dirs/>
        <property name="clean.tests.xml" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- ======================================================= -->
    <!-- Cleans the build directory                              -->
    <!-- ======================================================= -->
    <target name="clean-build" depends="init,break-links" unless="clean.build,configure.done"
        description="Cleans the build directory">
        <delete dir="${build}" quiet="true"/>
        <delete dir="${export.client.dir}" quiet="true"/>
        <make-dirs/>
        <property name="clean.build" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- cleans the deploy directory, with the exception of the domain -->
    <!-- ======================================================= -->
    <target name="clean-deploy" depends="init,break-links" unless="clean.deploy,configure.done"
        description="Cleans the deploy directory">
        <delete dir="${deploy}/app/.." quiet="true"/>
        <delete dir="${deploy}/cdm-batch-data/.." quiet="true"/>
        <delete dir="${deploy}/cdm-main-data/.." quiet="true"/>
        <delete dir="${deploy}/exportclient/.." quiet="true"/>
        <make-dirs/>
        <property name="clean.deploy" value="true"/>
    </target>

    <!-- ======================================================= -->
    <!-- cleans the gensrc/jaxb directory                             -->
    <!-- ======================================================= -->
    <target name="clean-jaxb" depends="init" unless="clean.jaxb,configure.done"
        description="Cleans the jaxb generated source directory: ${jaxb.output}">
        <delete dir="${jaxb.output}" quiet="true"/>
        <make-dirs/>
        <property name="clean.jaxb" value="true"/>
    </target>


</project>
