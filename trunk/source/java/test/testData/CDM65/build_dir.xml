<?xml version="1.0" encoding="UTF-8"?>
<project name="cdm-dir">
    <!--    This contains all the project directory creation for reuse across buildfiles.                       -->
    <!--    You use this by pasting the following block into your build file (uncommented, of course):          -->
    <!--        <import file="build_dir.xml"/>                                                            -->
    <!--        <import file="build_properties.xml"/>                                                     -->
    <!--        <import file="build_paths.xml"/>                                                          -->
    <!--        <import file="build_taskdefs.xml"/>                                                       -->
    <!--    and the targets of these files are magically imported into your buildfile.  Make your "init" target -->
    <!--    have these as a dependency as follows, and you'll have all you need magically imported:             -->
    <!--        <target name="init" depends="properties,paths,taskdefs" unless="init.done">                     -->


    <!-- ======================================================= -->
    <!-- Creates all build directories                           -->
    <!-- ======================================================= -->

    <target name="dir" depends="init">
        <make-dirs/>
    </target>

    <macrodef name="make-dirs">
        <sequential>
            <make-main-data-dir/>
            <make-server-data-dir/>
            <make-batch-data-dir/>
            <mkdir dir="${jaxb.output}"/>
            <mkdir dir="${base.dir}/genconf"/>
            <mkdir dir="${base.dir}/gensrc"/>
            <mkdir dir="${base.dir}/gensrc/jaxb"/>
            <mkdir dir="${build}"/>
            <mkdir dir="${cdm.main.approot}/cdm"/>
            <mkdir dir="${cdm.main.approot}/cdm/cdmWebApp/WEB-INF"/>
            <mkdir dir="${main.logdir}"/>
            <mkdir dir="${cdmdomain}"/>
            <mkdir dir="${classes}"/>
            <mkdir dir="${coverage.dir}"/>
            <mkdir dir="${deploy}"/>
            <mkdir dir="${docs}"/>
            <mkdir dir="${docs}/api"/>
            <mkdir dir="${docs}/coverage"/>
            <mkdir dir="${docs}/doccheck"/>
            <mkdir dir="${docs}/strutsdoc"/>
            <mkdir dir="${docs}/test"/>
            <mkdir dir="${docs}/integrationTest"/>
            <mkdir dir="${integration.classes}"/>
            <mkdir dir="${output}"/>
            <mkdir dir="${output}/integration_classes"/>
            <mkdir dir="${output}/test_classes"/>
            <mkdir dir="${test.classes}"/>
            <mkdir dir="${test.data.output}"/>

        </sequential>
    </macrodef>

    <target name="main-data-dir" depends="init">
        <echo message="main = ${cdm.main.datadir}"/>
        <make-main-data-dir/>
    </target>
    <target name="main-server-dir" depends="init">
        <make-server-data-dir/>
    </target>
    <target name="batch-data-dir" depends="init">
        <make-batch-data-dir/>
    </target>

    <!-- ======================================================= -->
    <!-- Creates app data directories                            -->
    <!-- ======================================================= -->
    <macrodef name="make-main-data-dir">
        <sequential>
            <mkdir dir="${main.logdir}"/>
            <mkdir dir="${cdm.main.datadir}/wlproxy"/>
            <mkdir dir="${docroot}"/>
            <mkdir dir="${docroot}/dtds"/>
            <mkdir dir="${docroot}/help"/>
            <mkdir dir="${docroot}/docs"/>
            <mkdir dir="${import.path}"/>
            <mkdir dir="${import.path}/spreadsheets"/>
            <mkdir dir="${export.output.path}"/>
            <mkdir dir="${docroot}/test"/>
            <mkdir dir="${images}"/>
            <mkdir dir="${images}/aprl"/>
            <mkdir dir="${images}/ftwr"/>
            <mkdir dir="${images}/eqmt"/>
        </sequential>
    </macrodef>

    <!-- ======================================================= -->
    <!-- Creates server data directories                            -->
    <!-- ======================================================= -->
    <macrodef name="make-server-data-dir">
        <sequential>
            <mkdir dir="${cdm.main.datadir}/logs"/>
        </sequential>
    </macrodef>

    <!-- ======================================================= -->
    <!-- Creates batch data directories                            -->
    <!-- ======================================================= -->
    <macrodef name="make-batch-data-dir">
        <sequential>
            <mkdir dir="${cdm.batch.datadir}/tmp"/>
            <mkdir dir="${batch.logdir}"/>
            <chgrp file="${batch.logdir}" group="b2bops" type="dir" verbose="true"/><!-- chgrp directory so that b2bbatch user can write files -->
            <chmod file="${batch.logdir}" perm="775" type="dir" verbose="true"/><!-- chmod directory so that b2bbatch user can write files -->
            <mkdir dir="${batch.logdir}/spool"/>
            <mkdir dir="${batch.export}"/>
            <mkdir dir="${batch.export}/archive"/>
            <mkdir dir="${batch.export}/catalogs"/>
            <mkdir dir="${batch.images}"/>
            <mkdir dir="${batch.images}/aprl"/>
            <mkdir dir="${batch.images}/eqmt"/>
            <mkdir dir="${batch.images}/ftwr"/>
            <mkdir dir="${batch.pdfs}"/>
            <mkdir dir="${batch.pdfs}/failure"/>
            <mkdir dir="${batch.pdfs}/incoming"/>
            <mkdir dir="${batch.pdfs}/output"/>
            <mkdir dir="${batch.pdfs}/processing"/>
            <mkdir dir="${batch.pdfs}/success"/>
            <mkdir dir="${batch.pdfs}/tempcatalogpdfs"/>
            <mkdir dir="${bml}"/>
            <mkdir dir="${bml}/archive"/>
            <mkdir dir="${bml}/archive/acknowledgements"/>
            <mkdir dir="${bml}/archive/manifests"/>
            <mkdir dir="${bml}/archive/requests"/>
            <mkdir dir="${bml}/confirmed"/>
            <mkdir dir="${bml}/incoming"/>
            <mkdir dir="${bml}/staging"/>
            <mkdir dir="${bml}/staging/aprl"/>
            <chmod file="${bml}/staging/aprl" perm="777" type="dir" verbose="true"/><!-- chmod directory so that bmlxfer user can write files -->
            <mkdir dir="${bml}/staging/eqmt"/>
            <chmod file="${bml}/staging/eqmt" perm="777" type="dir" verbose="true"/><!-- chmod directory so that bmlxfer user can write files -->
            <mkdir dir="${bml}/staging/ftwr"/>
            <chmod file="${bml}/staging/ftwr" perm="777" type="dir" verbose="true"/><!-- chmod directory so that bmlxfer user can write files -->
            <mkdir dir="${batch.import}"/>
        </sequential>
    </macrodef>
</project>